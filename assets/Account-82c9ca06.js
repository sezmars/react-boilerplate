import{h as C,t as F,n as w,j as e,B as p,v,r as f,H as j}from"./index-afb46ae3.js";import{u as y}from"./index.esm-973e1cc4.js";import{F as U,I as h}from"./Input-449d4b75.js";import{F as d}from"./FormRow-1c6c8685.js";import{u as S}from"./useMutation-2aa671db.js";import{F as N}from"./FileInput-32838afa.js";import{R as g}from"./Row-67d64498.js";const b=()=>{const s=C(),{mutate:o,isLoading:r}=S({mutationFn:F,onSuccess:({user:t})=>{w.success("User account successfully updated"),s.setQueryData(["user"],t)},onError:t=>w.error(t)});return{updateUser:o,isUpdating:r}},q=()=>{var c,m;const{register:s,handleSubmit:o,formState:r,getValues:t,reset:i}=y(),{errors:n}=r,{updateUser:l,isUpdating:u}=b(),x=async({password:a})=>{await l({password:a},{onSuccess:i})};return e.jsxs(U,{onSubmit:o(x),children:[e.jsx(d,{label:"New password (min 8 chars)",error:(c=n==null?void 0:n.password)==null?void 0:c.message,children:e.jsx(h,{type:"password",id:"password",autoComplete:"current-password",disabled:u,...s("password",{required:"This field is required",minLength:{value:8,message:"Password needs a minimum of 8 characters"}})})}),e.jsx(d,{label:"Confirm password",error:(m=n==null?void 0:n.passwordConfirm)==null?void 0:m.message,children:e.jsx(h,{type:"password",autoComplete:"new-password",id:"passwordConfirm",disabled:u,...s("passwordConfirm",{required:"This field is required",validate:a=>t().password===a||"Passwords need to match"})})}),e.jsxs(d,{children:[e.jsx(p,{onClick:i,type:"reset",variation:"secondary",children:"Cancel"}),e.jsx(p,{disabled:u,children:"Update password"})]})]})},E=()=>{var c,m;const s=(c=v())==null?void 0:c.user,{updateUser:o,isUpdating:r}=b(),[t,i]=f.useState((m=s==null?void 0:s.user_metadata)==null?void 0:m.currentFullName),[n,l]=f.useState(null),u=a=>{a.preventDefault(),t&&o({fullName:t,avatar:n},{onSuccess:()=>{l(null),a.target.reset()}})},x=()=>{var a;i((a=s==null?void 0:s.user_metadata)==null?void 0:a.currentFullName),l(null)};return e.jsxs(U,{onSubmit:u,children:[e.jsx(d,{label:"Email address",children:e.jsx(h,{value:s==null?void 0:s.email,disabled:!0})}),e.jsx(d,{label:"Full name",children:e.jsx(h,{type:"text",value:t,onChange:a=>i(a.target.value),id:"fullName",disabled:r})}),e.jsx(d,{label:"Avatar image",children:e.jsx(N,{id:"avatar",accept:"image/*",onChange:a=>l(a.target.files[0]),disabled:r})}),e.jsxs(d,{children:[e.jsx(p,{type:"reset",variation:"secondary",disabled:r,onClick:x,children:"Cancel"}),e.jsx(p,{disabled:r,children:"Update account"})]})]})},H=()=>e.jsxs(e.Fragment,{children:[e.jsx(j,{as:"h1",children:"Update your account"}),e.jsxs(g,{children:[e.jsx(j,{as:"h3",children:"Update user data"}),e.jsx(E,{})]}),e.jsxs(g,{children:[e.jsx(j,{as:"h3",children:"Update password"}),e.jsx(q,{})]})]});export{H as default};
