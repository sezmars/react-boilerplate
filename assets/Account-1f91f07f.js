import{h as C,t as v,n as f,j as e,B as m,v as y,r as w,H as j}from"./index-3a10c271.js";import{u as F}from"./index.esm-7a822f05.js";import{F as U,I as p}from"./Input-19501439.js";import{F as o}from"./FormRow-e6420671.js";import{u as S}from"./useMutation-e260d0de.js";import{F as N}from"./FileInput-c26c55c1.js";import{R as g}from"./Row-03356d13.js";const b=()=>{const s=C(),{mutate:d,isLoading:r}=S({mutationFn:v,onSuccess:({user:t})=>{f.success("User account successfully updated"),s.setQueryData(["user"],t)},onError:t=>f.error(t)});return{updateUser:d,isUpdating:r}},q=()=>{var u,a;const{register:s,handleSubmit:d,formState:r,getValues:t,reset:i}=F(),{errors:n}=r,{updateUser:l,isUpdating:c}=b(),h=async({password:x})=>{await l({password:x},{onSuccess:i})};return e.jsxs(U,{onSubmit:d(h),children:[e.jsx(o,{label:"New password (min 8 chars)",error:(u=n==null?void 0:n.password)==null?void 0:u.message,children:e.jsx(p,{type:"password",id:"password",autoComplete:"current-password",disabled:c,...s("password",{required:"This field is required",minLength:{value:8,message:"Password needs a minimum of 8 characters"}})})}),e.jsx(o,{label:"Confirm password",error:(a=n==null?void 0:n.passwordConfirm)==null?void 0:a.message,children:e.jsx(p,{type:"password",autoComplete:"new-password",id:"passwordConfirm",disabled:c,...s("passwordConfirm",{required:"This field is required",validate:x=>t().password===x||"Passwords need to match"})})}),e.jsxs(o,{children:[e.jsx(m,{onClick:i,type:"reset",variation:"secondary",children:"Cancel"}),e.jsx(m,{disabled:c,children:"Update password"})]})]})},E=()=>{var u;const{user:s}=y();console.log(s);const{updateUser:d,isUpdating:r}=b(),[t,i]=w.useState((u=s==null?void 0:s.user_metadata)==null?void 0:u.fullName),[n,l]=w.useState(null),c=a=>{a.preventDefault(),t&&d({fullName:t,avatar:n},{onSuccess:()=>{l(null),a.target.reset()}})},h=()=>{var a;i((a=s==null?void 0:s.user_metadata)==null?void 0:a.fullName),l(null)};return e.jsxs(U,{onSubmit:c,children:[e.jsx(o,{label:"Email address",children:e.jsx(p,{value:s==null?void 0:s.email,disabled:!0})}),e.jsx(o,{label:"Full name",children:e.jsx(p,{type:"text",value:t,onChange:a=>i(a.target.value),id:"fullName",disabled:r})}),e.jsx(o,{label:"Avatar image",children:e.jsx(N,{id:"avatar",accept:"image/*",onChange:a=>l(a.target.files[0]),disabled:r})}),e.jsxs(o,{children:[e.jsx(m,{type:"reset",variation:"secondary",disabled:r,onClick:h,children:"Cancel"}),e.jsx(m,{disabled:r,children:"Update account"})]})]})},H=()=>e.jsxs(e.Fragment,{children:[e.jsx(j,{as:"h1",children:"Update your account"}),e.jsxs(g,{children:[e.jsx(j,{as:"h3",children:"Update user data"}),e.jsx(E,{})]}),e.jsxs(g,{children:[e.jsx(j,{as:"h3",children:"Update password"}),e.jsx(q,{})]})]});export{H as default};
