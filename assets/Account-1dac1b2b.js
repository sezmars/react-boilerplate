import{m as C,z as y,p as f,j as e,B as m,C as F,d as w,H as j}from"./index-d1682d74.js";import{u as v}from"./index.esm-8e707ccf.js";import{F as U,I as p}from"./Input-ed27d7c9.js";import{F as d}from"./FormRow-3f2d7675.js";import{u as S}from"./useMutation-5daf5ea3.js";import{F as N}from"./FileInput-fa19a56d.js";import{R as g}from"./Row-040ff468.js";const b=()=>{const s=C(),{mutate:o,isLoading:r}=S({mutationFn:y,onSuccess:({user:t})=>{f.success("User account successfully updated"),s.setQueryData(["user"],t)},onError:t=>f.error(t)});return{updateUser:o,isUpdating:r}},q=()=>{var u,a;const{register:s,handleSubmit:o,formState:r,getValues:t,reset:i}=v(),{errors:n}=r,{updateUser:l,isUpdating:c}=b(),h=async({password:x})=>{await l({password:x},{onSuccess:i})};return e.jsxs(U,{onSubmit:o(h),children:[e.jsx(d,{label:"New password (min 8 chars)",error:(u=n==null?void 0:n.password)==null?void 0:u.message,children:e.jsx(p,{type:"password",id:"password",autoComplete:"current-password",disabled:c,...s("password",{required:"This field is required",minLength:{value:8,message:"Password needs a minimum of 8 characters"}})})}),e.jsx(d,{label:"Confirm password",error:(a=n==null?void 0:n.passwordConfirm)==null?void 0:a.message,children:e.jsx(p,{type:"password",autoComplete:"new-password",id:"passwordConfirm",disabled:c,...s("passwordConfirm",{required:"This field is required",validate:x=>t().password===x||"Passwords need to match"})})}),e.jsxs(d,{children:[e.jsx(m,{onClick:i,type:"reset",variation:"secondary",children:"Cancel"}),e.jsx(m,{disabled:c,children:"Update password"})]})]})},E=()=>{var u;const{user:s}=F();console.log(s);const{updateUser:o,isUpdating:r}=b(),[t,i]=w.useState((u=s==null?void 0:s.user_metadata)==null?void 0:u.fullName),[n,l]=w.useState(null),c=a=>{a.preventDefault(),t&&o({fullName:t,avatar:n},{onSuccess:()=>{l(null),a.target.reset()}})},h=()=>{var a;i((a=s==null?void 0:s.user_metadata)==null?void 0:a.fullName),l(null)};return e.jsxs(U,{onSubmit:c,children:[e.jsx(d,{label:"Email address",children:e.jsx(p,{value:s==null?void 0:s.email,disabled:!0})}),e.jsx(d,{label:"Full name",children:e.jsx(p,{type:"text",value:t,onChange:a=>i(a.target.value),id:"fullName",disabled:r})}),e.jsx(d,{label:"Avatar image",children:e.jsx(N,{id:"avatar",accept:"image/*",onChange:a=>l(a.target.files[0]),disabled:r})}),e.jsxs(d,{children:[e.jsx(m,{type:"reset",variation:"secondary",disabled:r,onClick:h,children:"Cancel"}),e.jsx(m,{disabled:r,children:"Update account"})]})]})},H=()=>e.jsxs(e.Fragment,{children:[e.jsx(j,{as:"h1",children:"Update your account"}),e.jsxs(g,{children:[e.jsx(j,{as:"h3",children:"Update user data"}),e.jsx(E,{})]}),e.jsxs(g,{children:[e.jsx(j,{as:"h3",children:"Update password"}),e.jsx(q,{})]})]});export{H as default};
