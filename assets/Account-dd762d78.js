import{m as C,z as y,p as f,j as e,B as m,C as F,d as w,H as j}from"./index-1435744e.js";import{u as v}from"./index.esm-f80a893c.js";import{F as U,I as p}from"./Input-924bbee6.js";import{F as d}from"./FormRow-7b0a68e3.js";import{u as S}from"./useMutation-7691fc56.js";import{F as N}from"./FileInput-bf80b79d.js";import{R as g}from"./Row-a32db5c6.js";const b=()=>{const s=C(),{mutate:o,isLoading:r}=S({mutationFn:y,onSuccess:({user:t})=>{f.success("User account successfully updated"),s.setQueryData(["user"],t)},onError:t=>f.error(t)});return{updateUser:o,isUpdating:r}},q=()=>{var c,a;const{register:s,handleSubmit:o,formState:r,getValues:t,reset:i}=v(),{errors:n}=r,{updateUser:l,isUpdating:u}=b(),h=async({password:x})=>{await l({password:x},{onSuccess:i})};return e.jsxs(U,{onSubmit:o(h),children:[e.jsx(d,{label:"New password (min 8 chars)",error:(c=n==null?void 0:n.password)==null?void 0:c.message,children:e.jsx(p,{type:"password",id:"password",autoComplete:"current-password",disabled:u,...s("password",{required:"This field is required",minLength:{value:8,message:"Password needs a minimum of 8 characters"}})})}),e.jsx(d,{label:"Confirm password",error:(a=n==null?void 0:n.passwordConfirm)==null?void 0:a.message,children:e.jsx(p,{type:"password",autoComplete:"new-password",id:"passwordConfirm",disabled:u,...s("passwordConfirm",{required:"This field is required",validate:x=>t().password===x||"Passwords need to match"})})}),e.jsxs(d,{children:[e.jsx(m,{onClick:i,type:"reset",variation:"secondary",children:"Cancel"}),e.jsx(m,{disabled:u,children:"Update password"})]})]})},E=()=>{var c;const{user:s}=F(),{updateUser:o,isUpdating:r}=b(),[t,i]=w.useState((c=s==null?void 0:s.user_metadata)==null?void 0:c.fullName),[n,l]=w.useState(null),u=a=>{a.preventDefault(),t&&o({fullName:t,avatar:n},{onSuccess:()=>{l(null),a.target.reset()}})},h=()=>{var a;i((a=s==null?void 0:s.user_metadata)==null?void 0:a.fullName),l(null)};return e.jsxs(U,{onSubmit:u,children:[e.jsx(d,{label:"Email address",children:e.jsx(p,{value:s==null?void 0:s.email,disabled:!0})}),e.jsx(d,{label:"Full name",children:e.jsx(p,{type:"text",value:t,onChange:a=>i(a.target.value),id:"fullName",disabled:r})}),e.jsx(d,{label:"Avatar image",children:e.jsx(N,{id:"avatar",accept:"image/*",onChange:a=>l(a.target.files[0]),disabled:r})}),e.jsxs(d,{children:[e.jsx(m,{type:"reset",variation:"secondary",disabled:r,onClick:h,children:"Cancel"}),e.jsx(m,{disabled:r,children:"Update account"})]})]})},H=()=>e.jsxs(e.Fragment,{children:[e.jsx(j,{as:"h1",children:"Update your account"}),e.jsxs(g,{children:[e.jsx(j,{as:"h3",children:"Update user data"}),e.jsx(E,{})]}),e.jsxs(g,{children:[e.jsx(j,{as:"h3",children:"Update password"}),e.jsx(q,{})]})]});export{H as default};
